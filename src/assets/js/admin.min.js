!function(a){"use strict";var b=Backbone.Router.extend({}),c=function(){var a=[],c=new b;return{Modules:a,registerModule:function(b,d,e,f){_.isFunction(e)&&c.route(b,d,function(){a[d]=new e(f||{})})},initialize:function(){Backbone.history.start({root:mlpSettings.adminUrl,pushState:!0,hashChange:!1})}}};window.MultilingualPress=new c,a(window.MultilingualPress.initialize)}(jQuery),function(a){"use strict";var b={init:function(){var b=this;b.setToggle(),a(document).on("click",".mlp_copy_button",function(c){c.preventDefault();var d=a(c.target).data("blog_id");b.copyPost(d)})},setToggle:function(){a(document).on("click","[data-toggle_selector]",function(){return"INPUT"===this.tagName?!0:(a(a(this).data("toggle_selector")).toggle(),!1)}),a("label.mlp_toggler").each(function(){var b=a('input[name="'+a("#"+a(this).attr("for")).attr("name")+'"]'),c=b.filter("[data-toggle_selector]");c.length&&b.on("change",function(){return a(c.data("toggle_selector")).toggle(c.is(":checked")),!0})})},copyPost:function(b){var c="mlp_translation_data_"+b,d=tinyMCE.get(c+"_content"),e=a("#content").val(),f=a("#excerpt").val(),g=tinyMCE.get("content"),h=a("#title").val(),i=a("#editable-post-name").html();h&&a("#"+c+"_title").val(h),e&&a("#"+c+"_content").val(e),i&&a("#"+c+"_name").val(i),f&&a("#"+c+"_excerpt").val(f),g&&d.setContent(g.getContent())}};a(function(){b.init()})}(jQuery),function(a){"use strict";var b=Backbone.View.extend({el:"#wpbody-content form",events:{"change #site-language":"adaptLanguage","change #mlp-base-site-id":"togglePluginsRow"},initialize:function(){setTimeout(function(){this.$language=a("#mlp-site-language"),this.$pluginsRow=a("#mlp-activate-plugins").closest("tr")}.bind(this),100)},adaptLanguage:function(b){var c=this.getLanguage(a(b.currentTarget));this.$language.find('[value="'+c+'"]').length&&this.$language.val(c)},getLanguage:function(a){var b=a.val();return b?b.replace("_","-"):"en-US"},togglePluginsRow:function(b){this.$pluginsRow.toggle(0<a(b.currentTarget).val())}});MultilingualPress.registerModule("network/site-new.php","AddNewSite",b)}(jQuery),function(a,b){"use strict";var c=Backbone.View.extend({el:"#"+b.metaBoxID,events:{"click #submit-mlp-language":"sendRequest"},initialize:function(){this.$languages=this.$el.find('li [type="checkbox"]'),this.$menu=a("#menu"),this.$menuToEdit=a("#menu-to-edit"),this.$spinner=this.$el.find(".spinner"),this.$submit=this.$el.find("#submit-mlp-language")},sendRequest:function(c){var d;c.preventDefault(),this.$submit.prop("disabled",!0),this.$spinner.addClass("is-active").show(),d={action:b.action,menu:this.$menu.val(),mlp_sites:this.getSites()},d[b.nonceName]=b.nonce,a.post(b.ajaxURL,d,this.handleResponse.bind(this))},getSites:function(){var b=[];return this.$languages.filter(":checked").each(function(){b.push(a(this).val())}),b},handleResponse:function(a){a.success&&a.data&&this.$menuToEdit.append(a.data),this.$languages.prop("checked",!1),this.$spinner.addClass("is-active").hide(),this.$submit.prop("disabled",!1)}});MultilingualPress.registerModule("nav-menus.php","NavMenus",c)}(jQuery,mlpNavMenusSettings),function(a){"use strict";var b=Backbone.View.extend({el:"#mlp-term-translations",events:{"change select":"propagateSelectedTerm"},initialize:function(){this.$selects=this.$el.find("select")},propagateSelectedTerm:function(b){var c,d;this.isPropagating||(this.isPropagating=!0,c=a(b.currentTarget),d=this.getSelectedRelation(c),""!==d&&this.$selects.not(c).each(function(b,c){this.selectTerm(a(c),d)}.bind(this)),this.isPropagating=!1)},getSelectedRelation:function(a){return a.find("option:selected").data("relation")||""},selectTerm:function(a,b){var c=a.find('option[data-relation="'+b+'"]');c.length?a.val(c.val()):this.getSelectedRelation(a)&&a.val(a.find("option").first().val())}});MultilingualPress.registerModule("edit-tags.php","TermTranslator",b)}(jQuery),function(a){"use strict";var b={init:function(){this.meta_box_init(),this.meta_box_toggle_switch()},meta_box_init:function(){a(".to_translate").hide(),a("input.do_translate[checked]").each(function(){var b=a(this).attr("data");a(".translate_"+b).toggle(),a("#content_"+b+"_ifr").height(400)})},meta_box_toggle_switch:function(){a(".do_translate").on("click",function(){var b=a(this).attr("data");a(".translate_"+b).toggle("slow"),a("#content_"+b+"_ifr").height(400)})}};a(function(){b.init()})}(jQuery),function(a,b){"use strict";function c(a,b){for(var c=0;c<a.length;c++)if(void 0!==a[c][0]&&void 0!==b[0]&&a[c][0]===b[0])return c;return-1}var d=[];a(".mlp_rsc_action_list input").on("change",function(){var b=a(this),e=b.parent(".mlp_advanced_translator_metabox"),f="stay"===b.val(),g=c(d,e);-1===g?f||d.push(e):f&&d.splice(g,1)}),a("body").hasClass("post-php")&&a("#publish").on("click",function(a){d.length&&!confirm(b.unsavedPostRelationships)&&(a.preventDefault(),a.stopPropagation())}),a.fn.mlp_search=function(b){var c=a.extend({remote_blog_id:this.data("remote_blog_id"),remote_post_id:this.data("remote_post_id"),source_blog_id:this.data("source_blog_id"),source_post_id:this.data("source_post_id"),search_field:"input.mlp_search_field",result_container:"ul.mlp_search_results",action:"mlp_search",nonce:"",spinner:'<span class="spinner no-float" style="display:block"></span>'},b),d=a(c.result_container).html(),e=a(c.search_field),f=[],g=function(b){a(c.result_container).html(b)},h=function(b){if(f[b])return void g(f[b]);g(c.spinner);var d=a.post(ajaxurl,{action:c.action,source_post_id:c.source_post_id,source_blog_id:c.source_blog_id,remote_post_id:c.remote_post_id,remote_blog_id:c.remote_blog_id,s:b});d.done(function(a){f[b]=a,g(a)})};e.on("keypress",function(a){return 13==a.which?!1:void 0}).on("keyup",function(b){b.preventDefault(),b.stopPropagation();var c=a.trim(a(this).val());c&&0!==c.length?2<c.length&&h(c):g(d)})},a(".mlp_rsc_save_reload").on("click.mlp",function(c){c.preventDefault(),c.stopPropagation();var d=a(this),e=d.data("source_post_id"),f=d.data("source_blog_id"),g=d.data("remote_post_id"),h=d.data("remote_blog_id"),i=a('input[name="mlp_rsc_action['+h+']"]:checked').val(),j=0,k="",l=function(){o("disconnect")},m=function(){k=a('input[name="post_title"]').val(),o("new_relation")},n=function(){j=a('input[name="mlp_add_post['+h+']"]:checked').val(),j&&"0"!==j?o("connect_existing"):alert(b.noPostSelected)},o=function(b){a.ajax({type:"POST",url:ajaxurl,data:{action:"mlp_rsc_"+b,source_post_id:e,source_blog_id:f,remote_post_id:g,remote_blog_id:h,new_post_id:j,new_post_title:k},success:function(){window.location.reload(!0)},async:!1})};if(i&&"stay"!=i)switch(i){case"disconnect":l();break;case"new":m();break;case"search":n()}})}(jQuery,mlpRelationshipControlL10n);